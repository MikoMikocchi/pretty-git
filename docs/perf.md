# Базовая проверка производительности (v0.1.x)

Этот документ описывает, как запустить простую базовую проверку производительности для Pretty Git без внешних зависимостей.

## Цели
- Измерять «стеночное» время (wall time) для каждого отчёта в нескольких итерациях.
- Опционально снимать RSS процесса на Unix/macOS (best‑effort через `ps`).
- Оставаться переносимым (только stdlib) и дружелюбным к CI.

## Задача Rake

```
rake perf:baseline REPO=/path/to/repo REPORTS="summary,files,authors,languages,activity,heatmap,hotspots,churn,ownership" FORMAT=console ITERS=3 [SINCE=2024-01-01] [UNTIL=2024-12-31]
```

- `REPO`: путь к Git‑репозиторию (по умолчанию — текущая директория).
- `REPORTS`: список отчётов через запятую.
- `FORMAT`: формат вывода (`console|json|csv|md|yaml|xml`).
- `ITERS`: число итераций на отчёт (по умолчанию: 3).
- `SINCE`/`UNTIL`: опциональные временные фильтры, прокидываются в CLI.

## Скрипт

Задача делегирует выполнение `scripts/perf_baseline.rb`, который:
- Вызывает напрямую CLI `bin/pretty-git` с заданным отчётом и параметрами.
- Использует `Process.clock_gettime(MONOTONIC)` для замера времени.
- Печатает время по итерациям и сводку (min/avg/max и пиковый RSS, если доступен).

## Заметки и советы
- Для стабильных измерений закройте фоновые приложения и работайте от сети.
- Предпочтительны крупные реальные репозитории или синтетические тяжёлые фикстуры, чтобы проявить узкие места.
- Используйте `FORMAT=json`, чтобы уменьшить накладные расходы консольного рендера в замерах.
- Сохраняйте результаты и окружение краткой заметкой в этом файле или логах CI.

## Результаты прогонов

### 2025-08-18 00:49 (+03:00)

- __Параметры__: `REPO=.` `REPORTS="summary,files"` `FORMAT=json` `ITERS=2`
- __Сводка__:
  - `summary`: min=0.15s avg=0.30s max=0.45s, RSS≈448 KB
  - `files`:   min=0.15s avg=0.16s max=0.16s, RSS≈464 KB
