# Совместимость (OS/TZ/кодировки)

Статус: Draft

## Windows/WSL
- Нормализация путей, поддержка длинных путей.
- CRLF — в текстовых форматах сохраняем LF; консоль — как есть.

### Длинные пути
- Windows: учитывать ограничение 260 символов; попытка обхода через префикс `\\?\` на уровне чтения.
- В экспортах сохраняем логические пути как в репозитории (POSIX‑вида), без префиксов.

### Bash/PowerShell/WSL
- Квотирование и экранирование аргументов к `git` — аккуратно, без оболочечных конструкций.
- Git Bash/WSL допустимы; различия в кодировке консоли не должны влиять на файлы экспорта.

## Кодировки
- Ввод/вывод в UTF‑8; в консоли возможны оговорки шрифта/терминала.

### Unicode нормализация
- macOS: HFS+ часто хранит имена в NFD; Linux/Windows — чаще NFC.
- Политика: внутренне нормализуем к NFC, экспортируем в NFC.
- Сортировки/сравнения выполняются по нормализованным строкам (см. `docs/determinism.md`).

## Часовые пояса/локали
- Входные даты — интерпретируем как локальные, если TZ не указан.
- Выходные даты — нормализуем в UTC.

### Детали
- Тесты/CI исполняются с `TZ=UTC` и локалью `C`.
- В консольном выводе локаль не должна менять формат дат (всегда ISO8601 UTC).

## Ограничения
- Очень длинные пути/имена могут обрезаться в консоли (визуально), данные — полные.
 - Путь, отличный только нормализацией Unicode, считается одним и тем же логическим путём.
 - Максимальная ширина терминала влияет только на визуальное представление.
